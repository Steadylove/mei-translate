# MeiTrans Feature Roadmap

## 1. AI 对话式翻译润色

在翻译结果基础上，支持用户与 AI 多轮对话来优化翻译质量。

### 前端

- [ ] 翻译结果弹窗底部添加"优化翻译"入口按钮
- [ ] 点击后展开对话输入框，支持输入润色指令
- [ ] 预设快捷指令按钮：「更口语化」「更正式」「更简洁」「保留术语」
- [ ] 展示多轮对话历史（原文 → 初始翻译 → 用户指令 → 优化结果）
- [ ] 支持"采纳"某一轮的翻译结果，替换当前显示
- [ ] 对话状态在弹窗关闭后清除

### 后端

- [ ] 新增 `POST /api/translate/refine` 接口
- [ ] 接收参数：原文、当前翻译、用户指令、对话历史
- [ ] 构建多轮对话 prompt，保持翻译上下文
- [ ] 复用现有 LLM provider 体系，使用用户配置的 API Key

---

## 2. 网页全文摘要 + 翻译

一键生成当前网页的 AI 摘要，并翻译成目标语言。

### 前端

- [ ] Popup 中添加「网页摘要」按钮（与「翻译全页」「PDF翻译」并列）
- [ ] 点击后向 content script 发消息提取页面正文内容
- [ ] content script 提取页面正文（排除导航、广告、侧边栏等）
- [ ] 提取结果发送到后端摘要 API
- [ ] 在页面右侧弹出摘要面板，展示：
  - 摘要（原文 + 翻译）
  - 关键要点列表（3-5 条）
  - 预计阅读时间
- [ ] 摘要面板支持拖拽移动、折叠/展开
- [ ] 支持复制摘要内容、TTS 朗读

### 后端

- [ ] 复用现有 `POST /api/summary` 接口
- [ ] 优化正文提取的 prompt，提升摘要质量
- [ ] 支持长文分段摘要（复用 progressiveSummarize）
- [ ] 摘要结果缓存（同一 URL 短期内不重复请求）

---

## 3. 翻译历史 & 生词本

自动记录翻译过的内容，支持收藏、搜索、复习。

### 前端

- [ ] 翻译结果弹窗添加「收藏」星标按钮
- [ ] 点击收藏时保存：原文、译文、来源 URL、时间戳、语言对
- [ ] 使用 Chrome Storage 存储收藏数据（IndexedDB 备选）
- [ ] Settings 页面新增「翻译历史」Tab
  - [ ] 按时间排序显示所有翻译记录
  - [ ] 搜索/筛选功能（按语言、时间范围、关键词）
  - [ ] 区分「全部历史」和「已收藏」
  - [ ] 支持批量删除、全部清空
- [ ] Settings 页面新增「生词本」Tab
  - [ ] 只展示已收藏的词汇
  - [ ] 卡片式展示：正面原文、背面译文（点击翻转）
  - [ ] 标记「已掌握」/「需复习」
  - [ ] 支持 TTS 朗读
- [ ] 导出功能：CSV、JSON、Anki 格式
- [ ] Popup 中显示今日翻译次数统计

### 后端

- [ ] 新增 `POST /api/history` 保存翻译记录
- [ ] 新增 `GET /api/history` 查询历史（分页、搜索）
- [ ] 新增 `PUT /api/history/:id/star` 切换收藏状态
- [ ] 新增 `DELETE /api/history/:id` 删除记录
- [ ] 新增 `GET /api/history/export` 导出数据
- [ ] D1 数据库新增 `translation_history` 表
- [ ] 历史记录自动清理策略（超过 90 天的未收藏记录自动删除）
